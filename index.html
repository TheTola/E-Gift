<script>
    const card = document.getElementById('card');
    const leftHalf = document.getElementById('left-half');
    const rightHalf = document.getElementById('right-half');
    const flipSound = document.getElementById('flipSound');
    const unfurlSound = document.getElementById('unfurlSound');
    const readButton = document.getElementById('readButton');
    const fullscreen = document.getElementById('fullscreen');
    const closeButton = document.getElementById('closeButton');

    let flipped = false;

    function playFlipSound() {
        flipSound.currentTime = 0;
        flipSound.play();
    }

    function flipCard() {
        flipped = !flipped;
        card.classList.toggle('flipped', flipped);
        playFlipSound();
        readButton.style.display = flipped ? "block" : "none";
    }

    readButton.addEventListener('click', () => {
        fullscreen.style.display = "block";

        if (unfurlSound) {
            unfurlSound.pause(); // Stop any existing playback
            unfurlSound.currentTime = 0; // Start from the beginning
            unfurlSound.playbackRate = 2.8; // Speed up by 2.8x
            unfurlSound.play().catch(error => console.log("Audio playback error:", error));
            
            // Stop after 3 seconds
            setTimeout(() => {
                unfurlSound.pause();
                unfurlSound.currentTime = 0; // Reset to the beginning
            }, 3000);
        }
    });

    closeButton.addEventListener('click', () => fullscreen.style.display = "none");
    fullscreen.addEventListener('click', () => fullscreen.style.display = "none");

    leftHalf.addEventListener('click', flipCard);
    rightHalf.addEventListener('click', flipCard);
</script>
